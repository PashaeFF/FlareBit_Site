{% extends 'layout.html' %}

{% block content %}
{% include 'sections/cover_with_nav.html' %}
        <div class="space">
            <div class="container">
                <div class="row gy-4">
                    {% if address %}
                    <div class="col-xl-4 col-md-6">
                        <div class="contact-info">
                            <div class="contact-info_icon">
                                <i class="fas fa-location-dot"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="box-title">Our Office Address</h4>
                                {% for address in address %}
                                    <span class="contact-info_text">
                                        <a href="{{ address.location_link }}" target="_blank">{{ address.address }}</a>
                                    </span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% if phone_numbers %}
                    <div class="col-xl-4 col-md-6">
                        <div class="contact-info">
                            <div class="contact-info_icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="box-title">Call Us Anytime</h4>
                                <span class="contact-info_text">
                                    {% for phone_number in phone_numbers %}
                                        <a href="tel:+{{ phone_number.number }}">{{ phone_number.number }}</a>
                                    {% endfor %}
                                </span>
                            </div>
                        </div>
                        </div>
                    {% endif %}
                    {% if emails %}
                    <div class="col-xl-4 col-md-6">
                        <div class="contact-info">
                            <div class="contact-info_icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="box-title">Send An Email</h4>
                                <span class="contact-info_text">
                                    {% for email in emails %}
                                        <a href="mailto:{{ email.email }}">{{ email.email }}</a>
                                    {% endfor %}
                                </span>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
       

    

        <div class="bg-smoke space" data-bg-src="/static/flarebit_site/assets/img/bg/contact_bg_1.png" id="contact-sec">
            <div class="container">
                <div class="row">
                    <div class="col-xl-8">
                        <div class="title-area mb-35 text-xl-start text-center">
                            <span class="sub-title">
                                <div class="icon-masking me-2">
                                    <span class="mask-icon" data-mask-src="/static/flarebit_site/assets/img/theme-img/title_shape_2.svg"></span>
                                    <img src="/static/flarebit_site/assets/img/theme-img/title_shape_2.svg" alt="shape">
                                </div>
                                contact with us!
                            </span>
                            <h2 class="sec-title">Have Any Questions?</h2>
                            <p class="sec-text">Enthusiastically disintermediate one-to-one leadership via business e-commerce. Dramatically reintermediate compelling process improvements rather than empowered relationships.</p>
                        </div>
                        <form action="/contact/send_email/" method="POST" class="contact-form">
                            {% csrf_token %}
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <input type="text" class="form-control" name="name" id="name" placeholder="Your Name">
                                    <i class="fal fa-user"></i>
                                </div>
                                <div class="form-group col-md-6">
                                    <input type="email" class="form-control" name="email" placeholder="Email Address">
                                    <i class="fal fa-envelope"></i>
                                </div>
                                <div class="form-group col-md-6">
                                    <select name="subject" id="subject" class="form-select">
                                        <option value="" disabled="disabled" selected="selected" hidden>Select Subject</option>
                                        {% for service in services_all %}
                                            <option value="{{ service.id }}">{{ service.title }}</option>
                                        {% endfor %}
                                    </select>
                                    <i class="fal fa-chevron-down"></i>
                                </div>
                                <div class="form-group col-md-6">
                                    <input type="tel" class="form-control" name="number" id="number" placeholder="Phone Number">
                                    <i class="fal fa-phone"></i>
                                </div>
                                <div class="form-group col-12">
                                    <textarea name="message" id="message" cols="30" rows="3" class="form-control" placeholder="Your Message"></textarea>
                                    <i class="fal fa-comment"></i>
                                </div>
                                <div class="form-btn text-xl-start text-center col-12">
                                    <button class="th-btn">
                                        Send Message<i class="fa-regular fa-arrow-right ms-2"></i>
                                    </button>
                                </div>
                            </div>
                            
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="map-sec">
            <iframe src="{{ map_embed }}" allowfullscreen="" loading="lazy"></iframe>
        </div>

<!-- <script>
function showFlashMessage(message, isSuccess) {
    const flashContainer = document.getElementById('flash-message');
    const flashText = document.getElementById('flash-text');
    const alertDiv = flashContainer.querySelector('.alert');
    
    // Convert to string if it's an object
    const displayMessage = typeof message === 'object' ? JSON.stringify(message) : message;
    
    flashText.textContent = displayMessage;
    alertDiv.classList.remove('alert-success', 'alert-danger');
    alertDiv.classList.add(isSuccess ? 'alert-success' : 'alert-danger');
    
    flashContainer.style.display = 'block';
    
    setTimeout(() => {
        flashContainer.style.display = 'none';
    }, 5000);
}

const form = document.querySelector('form');
form.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(form);
    
    try {
        const response = await fetch('/contact/send-email/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
            },
            body: formData
        });
        
        const data = await response.json();
        console.log('Response data:', data); // Debug için

        // Direkt mesajı kullan
        const message = data.message || 'An error occurred';
        showFlashMessage(message, data.success);
        
        if (data.success) {
            form.reset();
        }
        
    } catch (error) {
        console.error('Error:', error);
        showFlashMessage('An error occurred. Please try again later.', false);
    }
});
</script> -->
{% endblock %}